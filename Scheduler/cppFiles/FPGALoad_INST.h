int Inst[167][12] = {{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 19343616, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 8, 16, 0, 0},{268435456, 0, 20, 536870912, 1549310057, 798248, 0, 4096, 0, 0, 16, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 48, 4104, 458752, 0, 0, 0, 0, 12, 0, 201326640, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 33554432, 32768, 0, 0},{0, 64, 0, 0, 0, 795520, 0, 0, 4, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 134217728, 0},{0, 0, 0, 0, 0, 1475072, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 50331648, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 32, 0},{0, 0, 0, 10485760, 0, 0, 0, 0, 0, 0, 201326592, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 16, 0, 0, 0, 0, 0, 0, 0, 48, 0},{0, 0, 0, 0, 0, 0, 0, 0, 33554440, 0, 32, 0},{0, 0, 0, 0, 0, 939008, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 12, 0, 0, 0},{0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}};
int total_instructions = 167;
int sub_instructions = 12;


void delay_FPGALoad_INST(){
int count = 100;
for(int i=0;i<count;){
i = i + 1;
}
}


//Function to initialize/clear the Inst BRAM
void clearINSTBram(){
int i,j;
//Making enable and write_enable 0 for Instruction BRAMS
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*45, 0); //Making enable 0
delay_FPGALoad_INST();
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*46, 0); //Making write enable 0
delay_FPGALoad_INST();
//Writing 0 into BRAM
for(i=0;i<4096;i++){
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*44, i); //Writing address
delay_FPGALoad_INST();
for(j=0;j<sub_instructions;j++){
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*(47+j), 0); //Writing data in din
delay_FPGALoad_INST();
}
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*45, 1); //Making enable 1
delay_FPGALoad_INST();
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*46, 1); //Making write enable 1
delay_FPGALoad_INST();
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*45, 0); //Making enable 0
delay_FPGALoad_INST();
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*46, 0); //Making write enable 0
delay_FPGALoad_INST();
}
}


//Function to verify if the data BRAMs is properly cleared
void verifyClearINSTBram(){
int i,j;
int val,error_count;
error_count = 0;
//Making enable and write enable zero for Instruction BRAM
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*45, 0); //Making enable 0
delay_FPGALoad_INST();
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*46, 0); //Making write enable 0
delay_FPGALoad_INST();
//Reading Instructions from BRAM
for(i=0;i<4096;i++){
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*44, i); //Writing address,i is the offset
delay_FPGALoad_INST();
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*45, 1); //Making enable 1
delay_FPGALoad_INST();
for(j=0;j<sub_instructions;j++){
val = Xil_In32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*(59+j)); //Reading from BRAM
delay_FPGALoad_INST();
if(val != 0){
error_count = error_count + 1;
}
}
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*45, 0); //Making enable 0
delay_FPGALoad_INST();
}
printf("Initialization errors in INST BRAMs = %d\n",error_count);
}


//Function to write data into BRAM
void FPGALoadINST(){
int i,j;
//The base address of the LUD accelerator may needed to be changed. The base address assumed is 'XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR'
//Making enable and write_enable 0 for Instruction BRAMS
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*45, 0); //Making enable 0
delay_FPGALoad_INST();
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*46, 0); //Making write enable 0
delay_FPGALoad_INST();
//Writing Instructions into BRAM
for(i=0;i<total_instructions;i++){
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*44, i); //Writing address,i is the offset
delay_FPGALoad_INST();
for(j=0;j<sub_instructions;j++){
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*(47+j), Inst[i][j]); //Writing data in din
delay_FPGALoad_INST();
}
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*45, 1); //Making enable 1
delay_FPGALoad_INST();
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*46, 1); //Making write enable 1
delay_FPGALoad_INST();
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*45, 0); //Making enable 0
delay_FPGALoad_INST();
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*46, 0); //Making write enable 0
delay_FPGALoad_INST();
}
}


//Function to verify if Instructions is properly loaded into BRAMs
void verify_INST_FPGALoad(){
int i,j,val_int;
//Making enable and write enable zero for Instruction BRAM
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*45, 0); //Making enable 0
delay_FPGALoad_INST();
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*46, 0); //Making write enable 0
delay_FPGALoad_INST();
//Reading Instructions from BRAM
for(i=0;i<total_instructions;i++){
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*44, i); //Writing address,i is the offset
delay_FPGALoad_INST();
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*45, 1); //Making enable 1
delay_FPGALoad_INST();
for(j=0;j<sub_instructions;j++){
val_int = Xil_In32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*(59+j)); //Reading from BRAM
delay_FPGALoad_INST();
if(val_int != Inst[i][j]){
printf("Error in verification, i = %d, j = %d, Correct value = %d, BRAM value = %d\n",i,j,Inst[i][j],val_int);
}
}
Xil_Out32(XPAR_MYIP_LUDECOMPOSITION_0_BASEADDR + 4*45, 0); //Making enable 0
delay_FPGALoad_INST();
}
}


